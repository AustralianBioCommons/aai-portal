<div
  class="mx-auto flex max-w-6xl flex-col gap-8 p-6 sm:p-10 lg:flex-row lg:p-6"
>
  <div
    class="flex w-full flex-1 flex-col gap-6 rounded-md bg-white p-10 shadow-2xl lg:w-1/2"
  >
    <div class="rounded-md bg-sky-100 p-4 text-sm text-sky-900">
      Please register only one account to ensure fair sharing of computational
      resources. Multiple registrations are monitored and will result in account
      termination and data deletion.
    </div>
    @if (errorMessage) {
      <div
        id="register_error_message"
        class="rounded-md bg-red-100 p-4 text-sm text-red-900"
      >
        Registration failed: {{ errorMessage }}
      </div>
    }

    <h1 class="text-2xl font-medium text-gray-800">Create a Galaxy account</h1>
    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="space-y-4">
      <div class="relative">
        <label for="email" class="text-xs text-gray-600"> Email </label>
        <input
          id="email"
          type="email"
          formControlName="email"
          class="w-full rounded-md border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-100"
          [class.border-red-500]="isFieldInvalid('email')"]
        />
        @if (isFieldInvalid('email')) {
          <div class="absolute right-0 text-sm text-red-500">
            @for (error of getErrorMessages("email"); track error) {
              <small>{{ error }}</small><br/>
            }
          </div>
        }
      </div>

      <div class="relative">
        <label for="password" class="text-xs text-gray-600">Password</label>
        <input
          id="password"
          type="password"
          formControlName="password"
          class="w-full rounded-md border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-100"
          [class.border-red-500]="isFieldInvalid('password')"
        />
        <div class="mb-2 mt-1 text-xs text-gray-500">
          Passwords must be at least 8 characters in length and contain at
          least one uppercase letter, one lowercase letter, one number, and one
          special character.
        </div>
        @if ( isFieldInvalid("password")) {
          <div class="mt-0.5 text-sm text-red-500">
            @for (error of getErrorMessages("password"); track error) {
              <small>{{ error }}</small><br/>
            }
          </div>
        }
      </div>

      <div class="relative">
        <label for="password_confirmation" class="text-xs text-gray-600">
          Confirm Password
        </label>
        <input
          id="password_confirmation"
          type="password"
          formControlName="password_confirmation"
          class="w-full rounded-md border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-100"
          [class.border-red-500]="
            registerForm.hasError('passwordMismatch') &&
            registerForm.get('password_confirmation')?.touched
          "
        />
        @if (
          registerForm.hasError("passwordMismatch") &&
          registerForm.get("password_confirmation")?.touched
        ) {
          <div class="absolute right-0 text-sm text-red-500">
            <small>Passwords do not match</small>
          </div>
        }
      </div>

      <div class="relative">
        <label for="username" class="text-xs text-gray-600">
          Public Name (username)
        </label>
        <input
          id="username"
          type="text"
          formControlName="username"
          class="w-full rounded-md border px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-100"
          [class.border-red-500]="isFieldInvalid('username')"
        />
        @if ( isFieldInvalid("username")) {
          <div class="mt-0.5 text-sm text-red-500">
            @for (error of getErrorMessages("username"); track error) {
              <small>{{ error }}</small><br/>
            }
          </div>
        }
        <div class="mb-2 mt-6 text-xs text-gray-500">
          Your public name is an identifier that will be used to generate
          addresses for information you share publicly. Public names must be at
          least three characters in length and contain only lower-case letters,
          numbers, dots, underscores, and dashes ('.', '_', '-').
        </div>
      </div>

      <button
        type="submit"
        class="hover:cursor w-full rounded-md bg-galaxy-primary px-4 py-3 text-sm font-medium text-white transition-colors hover:bg-blue-950"
      >
        Register
      </button>
    </form>
    <span class="text-sm text-gray-800">
      Already have an account?
      <a
        class="font-medium text-blue-500 hover:text-blue-600"
        href="https://galaxy.test.biocommons.org.au/"
      >
        Return to Galaxy
      </a>
      and log in
    </span>
  </div>

  <div class="relative min-h-96 w-full flex-1 lg:w-1/2">
    @if (isFrameLoading) {
      <div class="absolute inset-0 z-10 flex flex-col justify-between">
        <div class="mt-36 pt-2 text-2xl font-medium text-gray-800">
          Terms of service
        </div>
        <div class="flex flex-grow items-center justify-center">
          <app-loading-spinner />
        </div>
      </div>
    }
    <iframe
      class="absolute inset-0 z-20 h-full min-h-96 w-full pt-6"
      title="terms-of-use"
      src="https://site.usegalaxy.org.au/about#terms-of-service"
      (load)="onFrameLoad()"
    ></iframe>
  </div>
</div>
